<div class="row">
    <div class="span12">

        <div class="widget ">
            <div class="widget-header">
                <i class="icon-th-list"></i>
                <h3>订单列表</h3>
            </div>
            <!-- /widget-header -->

            <div class="widget-content">
                <div class="alert hide" role="alert"></div>
                <div class="btn-toolbar">
                    <div class="btn-group">
                        <a href='{{urlfor "OrderController.Add"}}' class="btn btn-large btn-info"><span class="icon-plus"></span> 新建订单</a>
                    </div>
                </div>

                <form id="form-list" method="post" action="">
                    <table class="table table-striped table-bordered table-hover">
                        <thead>
                            <tr>
                                <th>状态</th>
                                <th>订单名称</th>
                                <th>订单出价</th>
                                <th>订单尺寸</th>
                                <th>订单日限额</th>
                                <th>订单总限额</th>
                                <th>订单投放周期</th>
                                <th>订单投放地址</th>
                                <th width="100">操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            {{range $k, $v := .list}}
                            <tr>
                                <td>{{$v.Stats}}</td>
                                <td>{{$v.Name}}</td>
                                <td class="center">{{$v.Price}}</td>
                                <td>{{$v.Size}}</td>
                                <td>{{$v.DayLimit}}</td>
                                <td>{{$v.TotalLimit}}</td>
                                <td>{{$v.Btime}} ~ {{$v.Etime}}</td>
                                <td>{{$v.Purl}}</td>
                                <td>
                                    <a class="btn btn-warning" onclick="return editOrder({{$v.Stats}});" href='{{urlfor "OrderController.Edit"}}?id={{$v.Id}}'>
                                        <i class="icon-pencil icon-white"></i> 编辑
                                    </a>
                                    <a class="btn btn-info" onclick="delOrder({{$v.Id}})" target="_blank" href='javascript:void(0);'>
                                        <i class="icon-trash icon-white"></i> 删除
                                    </a>
                                    <a class="btn btn-success" onclick="openOrder({{$v.Id}},1)" target="_blank" href='javascript:void(0);'>
                                        <i class="icon-ok icon-white"></i> 开启
                                    </a>
                                    <a class="btn btn-danger" onclick="openOrder({{$v.Id}},0)" target="_blank" href='javascript:void(0);'>
                                        <i class="icon-off icon-white"></i> 关闭
                                    </a>
                                </td>
                            </tr>
                            {{end}}
                        </tbody>
                        <tfoot>
                        </tfoot>
                    </table>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- /row -->
<script>
    function editOrder(stats) {
        if (stats == "投放中") {
            alert("请先关闭订单");
            return false;
        }
        return true;
    }

    function delOrder(id) {
        var d = confirm("是否删除该订单");
        if (d) {
            $.ajax({
                url: '{{urlfor "OrderController.Del"}}/?id=' + id,
                type: "get",
                dataType: "json",
                success: function(info) {
                    if (info.status == 0) {
                        alert(info.msg)
                        window.location.href = "/order/list"
                    } else {
                        alert(info.msg)
                    }
                }

            })
        }
    }

    function openOrder(id, status) {
        var msg = "";
        if (status == "1") {
            msg = "是否开启该订单";
        }
        if (status == "0") {
            msg = "是否关闭该订单";
        }
        var d = confirm(msg);
        if (d) {
            $.ajax({
                url: '{{urlfor "OrderController.Open"}}',
                type: "post",
                data: {
                    oid: id,
                    stats: status,
                },
                dataType: "json",
                success: function(info) {
                    if (info.status == 0) {
                        alert(info.msg)
                        window.location.href = "/order/list"
                    } else {
                        alert(info.msg)
                    }
                }

            })
        }
    }
</script>